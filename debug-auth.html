<!DOCTYPE html>
<html>
  <head>
    <title>Debug Authentication</title>
  </head>
  <body>
    <h1>Authentication Debug</h1>
    <div id="results"></div>

    <script>
      const results = document.getElementById("results");

      // Check localStorage for authentication data
      const token = localStorage.getItem("token");
      const user = localStorage.getItem("user");

      results.innerHTML = `
            <h2>LocalStorage Contents:</h2>
            <p><strong>Token:</strong> ${token || "No token found"}</p>
            <p><strong>User:</strong> ${user || "No user data found"}</p>
            
            <h2>Test API Call:</h2>
            <button onclick="testApiCall()">Test /trabajos endpoint</button>
            <div id="apiResult"></div>
        `;

      async function testApiCall() {
        const apiResult = document.getElementById("apiResult");

        try {
          const response = await fetch("http://localhost:3000/trabajos", {
            headers: {
              "Content-Type": "application/json",
              Authorization: token ? `Bearer ${token}` : "",
            },
          });

          const data = await response.text();
          apiResult.innerHTML = `
                    <p><strong>Status:</strong> ${response.status}</p>
                    <p><strong>Response:</strong> ${data}</p>
                `;
        } catch (error) {
          apiResult.innerHTML = `<p><strong>Error:</strong> ${error.message}</p>`;
        }
      }

      window.testApiCall = testApiCall;
    </script>
  </body>
</html>
